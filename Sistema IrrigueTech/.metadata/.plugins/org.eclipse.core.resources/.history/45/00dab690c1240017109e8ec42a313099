package com.joice.sistemaIrrigamento.view;

/**
 * 
 * @author Joice Marques
 * @since 10/04/2017
 * @category model
 * 
 */
import java.awt.BorderLayout;
import java.awt.EventQueue;
import com.joice.sistemaIrrigamento.controller.ClienteController;
import com.joice.sistemaIrrigamento.model.Cliente;
import com.joice.sistemaIrrigamento.model.ConnectionModel;
import com.joice.sistemaIrrigamento.model.ModeloTabela;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.table.DefaultTableModel;

import java.awt.Color;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.JButton;
import javax.swing.JLabel;
import java.awt.Font;
import java.awt.event.ActionListener;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.awt.event.ActionEvent;
import java.awt.CardLayout;
import javax.swing.SwingConstants;
import javax.swing.JTextPane;

public class PrincipalView extends JFrame {

	private JPanel contentPane;
	private JLabel lMenu;
	private JButton bChamado;
	private JButton bRelatorio;
	private JButton bSair;
	private JButton bPesquisar;
	private JButton bConfirmar;
	private JPanel paRelatorio;
	private JPanel paMenu;
	private JPanel paChamado;
	private JButton btnPesquisar;
	private JTable tableCliente;
	private JButton bConfirm;
	private JTextField tDataIni;
	private JTextField tDataFim;
	private JTextPane txRelatorio;
	private String cpfCliente;
	private JButton bGerarRel;
	private JLabel lbDataInicio;
	private JLabel lbDataFim;
	private JTextField tPesquisa;
	private JTextField nome;
	private Object[][] dados;
	
	ConnectionModel conn = new ConnectionModel();
	PreparedStatement pst = null;
	ResultSet rs = null;
	
	Cliente cli = new Cliente();
	
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					PrincipalView frame = new PrincipalView();
					frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	public PrincipalView() {
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(100, 100, 600, 400);
		contentPane = new JPanel();
		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(contentPane);
		contentPane.setLayout(new CardLayout(0, 0));
		
		paMenu = new JPanel();
		contentPane.add(paMenu, "name_230167881840791");
		paMenu.setLayout(null);
		
		lMenu = new JLabel("MENU");
		lMenu.setBounds(0, 31, 574, 25);
		paMenu.add(lMenu);
		lMenu.setHorizontalAlignment(SwingConstants.CENTER);
		lMenu.setFont(new Font("Century Gothic", Font.BOLD, 14));
		
		bChamado = new JButton("Abrir Chamado");
		bChamado.setBounds(224, 82, 123, 33);
		paMenu.add(bChamado);
		bChamado.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				paMenu.setVisible(false);
				paChamado.setVisible(true);
			}
		});
		
		bChamado.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		
		bRelatorio = new JButton("Relat\u00F3rio");
		bRelatorio.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				paMenu.setVisible(false);
				paRelatorio.setVisible(true);
			}
		});
		bRelatorio.setBounds(224, 126, 123, 33);
		paMenu.add(bRelatorio);
		bRelatorio.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		
		bSair = new JButton("Sair");
		bSair.setBounds(224, 286, 123, 33);
		paMenu.add(bSair);
		bSair.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
			}
		});
		bSair.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		
		paRelatorio = new JPanel();
		contentPane.add(paRelatorio, "name_245579380842179");
		paRelatorio.setLayout(null);		
		
				
		tDataIni = new JTextField();
		tDataIni.setBounds(97, 27, 86, 20);
		paRelatorio.add(tDataIni);
		tDataIni.setColumns(10);
				
		tDataFim = new JTextField();
		tDataFim.setBounds(97, 58, 86, 20);
		paRelatorio.add(tDataFim);
		tDataFim.setColumns(10);
				
		txRelatorio = new JTextPane();
		txRelatorio.setBounds(10, 88, 554, 252);
		paRelatorio.add(txRelatorio);
				
		bGerarRel = new JButton("Gerar Relat\u00F3rio");
		bGerarRel.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		bGerarRel.setBounds(441, 41, 123, 33);
		paRelatorio.add(bGerarRel);
				
		lbDataInicio = new JLabel("Data Inicial:");
		lbDataInicio.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		lbDataInicio.setBounds(10, 29, 86, 14);
		paRelatorio.add(lbDataInicio);
				
		lbDataFim = new JLabel("Data Final:");
		lbDataFim.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		lbDataFim.setBounds(10, 60, 86, 14);
		paRelatorio.add(lbDataFim);
		
		paChamado = new JPanel();
		contentPane.add(paChamado, "name_230350538544804");
		paChamado.setLayout(null);
		
		btnPesquisar = new JButton("Pesquisar");
		btnPesquisar.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		btnPesquisar.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				cli.setPesquisa(tPesquisa.getText());
				try {
					preencherTabela("Select * from cliente where nomecliente like '%" + cli.getPesquisa() + "%'");
					/*
					pst = conn.getConexao().prepareStatement(sql);
					rs = pst.executeQuery();
					
					ClienteController cliCon = new ClienteController();
					
					cliCon.buscaCliente(cli);*/
					/*
					Cliente cliente = cliCon.buscaCliente(cli);*/
				} catch (SQLException e1) {
					// TODO Auto-generated catch block
					e1.printStackTrace();
				}
				//nome.setText(cli.getNomeCliente());
					
			}
		});
		btnPesquisar.setBounds(336, 40, 89, 33);
		paChamado.add(btnPesquisar);
		
		tableCliente = new JTable();
		tableCliente.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		tableCliente.setBounds(10, 103, 554, 80);
		paChamado.add(tableCliente);
		
		bConfirm = new JButton("OK");
		bConfirm.setFont(new Font("Century Gothic", Font.PLAIN, 12));
		bConfirm.setBounds(237, 307, 89, 33);
		paChamado.add(bConfirm);
		
		tPesquisa = new JTextField();
		tPesquisa.setBounds(125, 41, 190, 33);
		paChamado.add(tPesquisa);
		tPesquisa.setColumns(10);
		
		nome = new JTextField();
		nome.setBounds(449, 47, 86, 20);
		paChamado.add(nome);
		nome.setColumns(10);		
	}
	
	public void preencherTabela(String sql) throws SQLException{
		ArrayList dados = new ArrayList();
		String[] colunas = new String[]{"Nome Cliente"};
		
		pst = conn.getConexao().prepareStatement(sql);
		rs = pst.executeQuery();
		
		try {
			while(rs.next()){
				dados.add(new Object[]{rs.getString("nomecliente")});
			}			
		} catch (Exception e) {
			System.out.println(e.getMessage());
		}
		ModeloTabela modelo = new ModeloTabela(dados, colunas);
		tableCliente.setModel(modelo);		
    }
}
